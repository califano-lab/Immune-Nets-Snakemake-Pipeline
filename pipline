rule all:
    input:
        "final_data.h5ad"

rule preprocess_data:
    input:
        matrix_file = "/Users/lzy/Desktop/bm_scp_gex_matrix.csv",
        meta_file = "/Users/lzy/Desktop/bm_scp_meta_(1).txt"
    output:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/raw_data.h5ad"
    script:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/scripts/preprocess_data.py"

rule qc:
    input:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/raw_data.h5ad"
    output:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/qc_data.h5ad"
    script:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/scripts/qc.py"

rule normalize_data:
    input:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/qc_data.h5ad"
    output:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/normalized_data.h5ad"
    script:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/scripts/normalize_data.py"

rule pca_analysis:
    input:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/normalized_data.h5ad"
    output:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/pca_data.h5ad"
    script:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/scripts/pca_analysis.py"

rule umap_clustering:
    input:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/pca_data.h5ad"
    output:
        "/Users/lzy/Desktop/Immune-Nets/scrnaseq_pipeline/umap_data.h5ad"
    script:
        "/Users/lzy/Desktop/Imm
